# build_scripts

常见的构建脚本都是基于 shell 实现，主要就是 bash。简单的构建脚本优先使用 shell 实现，但是如果稍为复杂一点的构建脚本，继续使用 shell 脚本就会得异常麻烦。

## shell 脚本的问题

- bash 的语法一致性差，内置功能非常少
  - 一些新型的 shell，比如 nushell 开始内置大量功能，反而提高了学习的成本。
  - shell 更注重交互，而不是功能的强大。
- 一个 shell 实现一些功能需要组合多个命令行工具实现，比如字符串处理，实现这些功能需要学习多个不同的命令行工具，很有可能是小型语言规模的工具，无论编写或测试都需要相当的时间成本。
  - 现实是一处编写，处处复制
- 代码复用
  - shell 的代码复用基本上依赖 ctrl-c/v
- shell 的移植性现实中等于 0
  - 基于 linux 环境的 shell 脚本，在 windows 环境上几乎不能执行

# 解决方案

基于 python 编写构建脚本，并实现一个类似于 shell 的 dsl。主要用于稍复杂的过程过程。

学习成本、广泛使用、内置功能丰富是选择 python 的主要原因。考虑到构建脚本的性质只考虑使用内置功能实现构建过程，最好没有三方依赖，代码规模也需要控制在一个比较少的范围。因此 python 是相当好的选择。

## 特性

- shell DSL
  - 基于 python 实现的 shell 命令 dsl
  - dsl 符合 shell 的常见用法，也更方式与 python 代码进行集成
  - dsl 也方便迁移原来的构建脚本
- 动态配置任务
  - 通过串行运行，实现多级的构建目标
  - 通过 start.builder_list 控制构建任务，runner 会从 builders 包中查找相应的模块
    - 稍改可以实现从环境变量获取任务
- 简单的构建目标实现
  - 每个构建目标实际上是一个 python 的模块
    - 模块里需要导出 Builder 类，并提供 build 方法
  - 构建目标的代码由 runner 执行

## LICENSE

[MIT](LICENSE)
